--- mysql-4.0.15/acinclude.m4.lib64	2003-09-06 08:35:50.000000000 +0200
+++ mysql-4.0.15/acinclude.m4	2003-09-14 14:32:09.791510979 +0200
@@ -743,8 +743,9 @@
        fi
       done
 
-      for d in /usr/ssl/lib /usr/local/ssl/lib /usr/lib/openssl \
-/usr/lib /usr/lib64 /opt/ssl/lib /opt/openssl/lib /usr/local/lib/ ; do
+
+  for d in /usr/ssl/$MYSQL_LIB /usr/local/ssl//$MYSQL_LIB /usr/$MYSQL_LIB/openssl \
+ /usr/$MYSQL_LIB /opt/ssl/$MYSQL_LIB /opt/openssl/$MYSQL_LIB /usr/local/$MYSQL_LIB/ ; do
       if test -f $d/libssl.a ; then
         OPENSSL_LIB=$d
       fi
@@ -1077,7 +1078,7 @@
 dnl echo ["MYSQL_CHECK_BDB_DIR ($1)"]
   dir="$1"
 
-  MYSQL_CHECK_INSTALLED_BDB([$dir/include], [$dir/lib])
+  MYSQL_CHECK_INSTALLED_BDB([$dir/include], [$dir/$MYSQL_LIB])
 
   if test X"$bdb_dir_ok" != Xinstalled; then
     # test to see if it's a source dir
--- mysql-4.0.15/configure.in.lib64	2003-09-06 08:35:52.000000000 +0200
+++ mysql-4.0.15/configure.in	2003-09-14 14:29:26.995209485 +0200
@@ -2113,6 +2113,33 @@
 fi
 AC_SUBST(tools_dirs)
 
+# Check for native library dir name
+case $host in
+*-*-linux*)
+  # Test if the compiler is 64bit
+  echo 'int i;' > conftest.$ac_ext
+  mysql_cv_cc_64bit_output=no
+  if AC_TRY_EVAL(ac_compile); then
+    case `/usr/bin/file conftest.$ac_objext` in
+    *"ELF 64"*)
+      mysql_cv_cc_64bit_output=yes
+      ;;
+    esac
+  fi
+  rm -rf conftest*
+  ;;
+esac
+
+case $host_cpu:$mysql_cv_cc_64bit_output in
+powerpc64:yes | s390x:yes | sparc64:yes | x86_64:yes)
+  MYSQL_LIB="lib64"
+  ;;
+*:*)
+  MYSQL_LIB="lib"
+  ;;
+esac
+
+
 #MYSQL_CHECK_CPU
 MYSQL_CHECK_MYSQLFS
 MYSQL_CHECK_VIO
