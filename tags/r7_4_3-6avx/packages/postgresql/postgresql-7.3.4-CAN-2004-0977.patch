--- postgresql-7.3.4/contrib/findoidjoins/make_oidjoins_check.can-2004-0977	2002-09-05 13:57:32.000000000 -0600
+++ postgresql-7.3.4/contrib/findoidjoins/make_oidjoins_check	2004-12-07 16:09:15.000000000 -0700
@@ -10,27 +10,31 @@
 # Caution: you may need to use GNU awk.
 AWK=${AWK:-awk}
 
-trap "rm -f /tmp/$$ /tmp/$$a /tmp/$$b" 0 1 2 3 15
+INPUTFILE="`mktemp /tmp/make_oidjoins_check.input.XXXXXX`" || exit 1
+DUPSFILE="`mktemp /tmp/make_oidjoins_check.dups.XXXXXX`" || exit 1
+NONDUPSFILE="`mktemp /tmp/make_oidjoins_check.nondups.XXXXXX`" || exit 1
+
+trap "rm -f $INPUTFILE $DUPSFILE $NONDUPSFILE" 0 1 2 3 15
 
 # Read input
-cat "$@" >/tmp/$$
+cat "$@" >$INPUTFILE
 
 # Look for fields with multiple references.
-cat /tmp/$$ | cut -d' ' -f2 | sort | uniq -d >/tmp/$$a
-if [ -s /tmp/$$a ] ; then
+cat $INPUTFILE | cut -d' ' -f2 | sort | uniq -d >$DUPSFILE
+if [ -s $DUPSFILE ] ; then
 	echo "Ignoring these fields that link to multiple tables:" 1>&2
-	cat /tmp/$$a 1>&2
+	cat $DUPSFILE 1>&2
 fi
 
 # Get the non-multiply-referenced fields.
-cat /tmp/$$ | while read LINE
+cat $INPUTFILE | while read LINE
 do
 	set -- $LINE
-	grep "^$2\$" /tmp/$$a >/dev/null 2>&1 || echo $LINE
-done >/tmp/$$b
+	grep "^$2\$" $DUPSFILE >/dev/null 2>&1 || echo $LINE
+done >$NONDUPSFILE
 
 # Generate the output.
-cat /tmp/$$b |
+cat $NONDUPSFILE |
 $AWK -F'[ \.]' '\
 	BEGIN \
 	{
