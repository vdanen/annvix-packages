Upstream fix for CVE-2007-3780: a password length byte >= 128 can crash
the mysql server (probably only on 64-bit architectures).


diff -Naur mysql-5.0.22.orig/sql/sql_parse.cc mysql-5.0.22/sql/sql_parse.cc
--- mysql-5.0.22.orig/sql/sql_parse.cc	2006-05-25 04:56:41.000000000 -0400
+++ mysql-5.0.22/sql/sql_parse.cc	2007-08-27 15:25:49.000000000 -0400
@@ -1003,7 +1003,7 @@
     password both send '\0'.
   */
   uint passwd_len= thd->client_capabilities & CLIENT_SECURE_CONNECTION ?
-    *passwd++ : strlen(passwd);
+    (uchar) (*passwd++) : strlen(passwd);
   db= thd->client_capabilities & CLIENT_CONNECT_WITH_DB ?
     db + passwd_len + 1 : 0;
   uint db_len= db ? strlen(db) : 0;
