--- freetype-2.1.10/src/pcf/pcfread.c.cve-2006-3467	2006-07-17 12:43:03.828584361 -0600
+++ freetype-2.1.10/src/pcf/pcfread.c	2006-07-17 12:47:02.685960533 -0600
@@ -439,6 +439,13 @@ THE SOFTWARE.
 
     for ( i = 0; i < nprops; i++ )
     {
+      /* detect invalid string length - is the the best error code to return? */
+      if ( props[i].name < 0 ) 
+      {
+        error = FT_Err_Invalid_File_Format;
+        goto Bail;
+      }
+    
       /* XXX: make atom */
       if ( FT_NEW_ARRAY( properties[i].name,
                          ft_strlen( strings + props[i].name ) + 1 ) )
@@ -451,6 +458,13 @@ THE SOFTWARE.
 
       if ( props[i].isString )
       {
+        /* detect invalid string length - is the the best error code to return? */
+        if ( props[i].value < 0 ) 
+        {
+          error = FT_Err_Invalid_File_Format;
+          goto Bail;
+        }
+
         if ( FT_NEW_ARRAY( properties[i].value.atom,
                            ft_strlen( strings + props[i].value ) + 1 ) )
           goto Bail;
