--- tar-1.15.1/src/common.h.cve-2006-6097	2004-12-21 07:31:58.000000000 -0700
+++ tar-1.15.1/src/common.h	2006-11-28 09:47:53.000000000 -0700
@@ -124,6 +124,9 @@ GLOBAL size_t record_size;
 
 GLOBAL bool absolute_names_option;
 
+/* Allow GNUTYPE_NAMES type? */
+GLOBAL bool allow_name_mangling_option;
+
 /* Display file times in UTC */
 GLOBAL bool utc_option;
 
--- tar-1.15.1/src/tar.c.cve-2006-6097	2004-12-21 07:11:26.000000000 -0700
+++ tar-1.15.1/src/tar.c	2006-11-28 10:42:25.000000000 -0700
@@ -181,6 +181,7 @@ assert_format(unsigned fmt_mask)
 enum
 {
   ANCHORED_OPTION = CHAR_MAX + 1,
+  ALLOW_NAME_MANGLING_OPTION,
   ATIME_PRESERVE_OPTION,
   BACKUP_OPTION,
   CHECKPOINT_OPTION,
@@ -528,6 +529,8 @@ static struct argp_option options[] = {
 
   {NULL, 'o', 0, 0,
    N_("when creating, same as --old-archive. When extracting, same as --no-same-owner"), 91 },
+  {"allow-name-mangling", ALLOW_NAME_MANGLING_OPTION, 0, 0,
+   N_("when creating, allow GNUTYPE_NAMES mangling -- considered dangerous"), 92 },
 
   {NULL, 0, NULL, 0,
    N_("Other options:"), 100 },
@@ -914,6 +917,10 @@ parse_opt(int key, char *arg, struct arg
       set_use_compress_program_option ("compress");
       break;
       
+    case ALLOW_NAME_MANGLING_OPTION:
+      allow_name_mangling_option = true;
+      break;
+      
     case ANCHORED_OPTION:
       args->exclude_options |= EXCLUDE_ANCHORED;
       break;
--- tar-1.15.1/src/extract.c.cve-2006-6097	2004-12-21 02:55:12.000000000 -0700
+++ tar-1.15.1/src/extract.c	2006-11-28 10:47:58.000000000 -0700
@@ -1101,7 +1101,13 @@ extract_archive (void)
       break;
 
     case GNUTYPE_NAMES:
+      if (allow_name_mangling_option) {
       extract_mangle ();
+      }
+      else {
+        ERROR ((0, 0, _("GNUTYPE_NAMES mangling ignored")));
+        skip_member ();
+      }
       break;
 
     case GNUTYPE_MULTIVOL:
