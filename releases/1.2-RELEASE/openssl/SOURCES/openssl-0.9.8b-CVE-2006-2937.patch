--- openssl-0.9.8b/crypto/asn1/tasn_dec.c.cve-2006-2937	2006-02-19 06:45:22.000000000 -0700
+++ openssl-0.9.8b/crypto/asn1/tasn_dec.c	2006-09-27 10:35:19.000000000 -0600
@@ -832,6 +832,9 @@ static int asn1_d2i_ex_primitive(ASN1_VA
 		}
 	else if (ret == -1)
 		return -1;
+
+	ret = 0;
+
 	/* SEQUENCE, SET and "OTHER" are left in encoded form */
 	if ((utype == V_ASN1_SEQUENCE)
 		|| (utype == V_ASN1_SET) || (utype == V_ASN1_OTHER))
