--- openssl-0.9.8b/ssl/ssl_lib.c.cve-2006-3738	2005-12-05 10:32:21.000000000 -0700
+++ openssl-0.9.8b/ssl/ssl_lib.c	2006-09-27 10:39:01.000000000 -0600
@@ -1219,7 +1219,7 @@ char *SSL_get_shared_ciphers(const SSL *
 		c=sk_SSL_CIPHER_value(sk,i);
 		for (cp=c->name; *cp; )
 			{
-			if (len-- == 0)
+			if (len-- <= 0)
 				{
 				*p='\0';
 				return(buf);
--- openssl-0.9.8b/ssl/s3_srvr.c.cve-2006-3738	2006-09-27 10:39:24.000000000 -0600
+++ openssl-0.9.8b/ssl/s3_srvr.c	2006-09-27 10:40:20.000000000 -0600
@@ -2003,7 +2003,7 @@ int ssl3_get_client_key_exchange(SSL *s)
 
                 if (kssl_ctx->client_princ)
                         {
-                        int len = strlen(kssl_ctx->client_princ);
+                        size_t len = strlen(kssl_ctx->client_princ);
                         if ( len < SSL_MAX_KRB5_PRINCIPAL_LENGTH ) 
                                 {
                                 s->session->krb5_client_princ_len = len;
