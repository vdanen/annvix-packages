--- openldap-2.3.38/servers/slapd/back-bdb/modrdn.c.cve-2008-0658	2008-02-29 12:26:32.000000000 -0500
+++ openldap-2.3.38/servers/slapd/back-bdb/modrdn.c	2008-02-29 12:27:31.000000000 -0500
@@ -729,6 +729,8 @@ retry:	/* transaction retry */
 		} else {
 			rs->sr_err = LDAP_X_NO_OPERATION;
 			ltid = NULL;
+			/* Only free attrs if they were dup'd.  */
+			if ( dummy.e_attrs == e->e_attrs ) dummy.e_attrs = NULL;
 			goto return_results;
 		}
 
