--- php-5.2.0/ext/session/session.c.cve-2006-6383	2006-10-06 15:11:36.000000000 -0600
+++ php-5.2.0/ext/session/session.c	2007-02-06 17:35:42.319564750 -0700
@@ -158,6 +158,10 @@ static PHP_INI_MH(OnUpdateSaveDir)
 		} else {
 			p = new_value;
 		}
+		
+		if (memchr(new_value, '\0', new_value_length) != NULL) {
+                        return FAILURE;
+                }
 
 		if (PG(safe_mode) && (!php_checkuid(p, NULL, CHECKUID_ALLOW_ONLY_DIR))) {
 			return FAILURE;
