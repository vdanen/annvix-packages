--- tcpdump-3.9.4/print-802_11.c.cve-2007-1218	2005-07-30 15:37:50.000000000 -0600
+++ tcpdump-3.9.4/print-802_11.c	2007-03-07 04:58:11.000000000 -0700
@@ -190,6 +190,8 @@ parse_elements(struct mgmt_body_t *pbody
 
 			if (pbody->tim.length <= 3)
 				break;
+			if (pbody->tim.length - 3 > sizeof pbody->tim.bitmap)
+				return 0;
 			if (!TTEST2(*(p + offset), pbody->tim.length - 3))
 				return 0;
 			memcpy(pbody->tim.bitmap, p + (pbody->tim.length - 3),
