
Author: jorton
Date: Tue Dec  6 02:21:41 2005
New Revision: 354394

URL: http://svn.apache.org/viewcvs?rev=354394&view=rev
Log:
* modules/ssl/ssl_engine_kernel.c (ssl_hook_Access): Omit further
access control checks if SSL is not in use regardless of vhost
settings.

Submitted by: Rüdiger Plüm, Joe Orton
PR: 37791

--- httpd-2.0.52/modules/ssl/ssl_engine_kernel.c.cve3357
+++ httpd-2.0.52/modules/ssl/ssl_engine_kernel.c
@@ -193,7 +193,7 @@
     /*
      * Check to see if SSL protocol is on
      */
-    if (!(sc->enabled || ssl)) {
+    if (!sc->enabled || !ssl) {
         return DECLINED;
     }
     /*
