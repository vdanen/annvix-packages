diff -Naur php-4.3.6/acinclude.m4 php-4.3.6.oden/acinclude.m4
--- php-4.3.6/acinclude.m4	2004-01-20 02:11:40.000000000 +0100
+++ php-4.3.6.oden/acinclude.m4	2004-05-21 14:02:28.234684728 +0200
@@ -180,7 +180,7 @@
   unset ac_new_flags
   for i in [$]$1; do
     case [$]i in
-    -L/usr/lib|-L/usr/lib/[)] ;;
+    -L/usr/lib|-L/usr/lib/|-L/usr/lib64|-L/usr/lib64/) ;;
     *[)] ac_new_flags="[$]ac_new_flags [$]i" ;;
     esac
   done
@@ -836,7 +836,7 @@
 dnl add a library to linkpath/runpath
 dnl
 AC_DEFUN([PHP_ADD_LIBPATH],[
-  if test "$1" != "/usr/lib"; then
+  if test "$1" != "/usr/lib" && test "$1" != "/usr/lib64"; then
     PHP_EXPAND_PATH($1, ai_p)
     ifelse([$2],,[
       _PHP_ADD_LIBPATH_GLOBAL([$ai_p])
@@ -1539,6 +1539,40 @@
   	fi
 ])
 
+dnl PHP_CHECK_LIBNAME
+dnl
+dnl Determine libdir name.
+dnl
+AC_DEFUN([PHP_CHECK_LIBNAME], [
+  AC_REQUIRE([AC_CANONICAL_HOST])dnl
+  AC_REQUIRE([AC_CANONICAL_BUILD])dnl
+  AC_MSG_CHECKING([libdir name])
+  case $host in
+  *-*-linux*)
+ # Test if the compiler is 64bit
+ echo 'int i;' > conftest.$ac_ext
+ php_cv_cc_64bit_output=no
+ if AC_TRY_EVAL(ac_compile); then
+   case `/usr/bin/file conftest.$ac_objext` in
+   *"ELF 64"*)
+     php_cv_cc_64bit_output=yes
+     ;;
+   esac
+ fi
+ rm -rf conftest*
+ ;;
+  esac
+  
+  case $host_cpu:$php_cv_cc_64bit_output in
+  powerpc64:yes | s390x:yes | sparc64:yes | x86_64:yes)
+ PHP_LIBNAME="lib64"
+ ;;
+  *:*)
+ PHP_LIBNAME="lib"
+ ;;
+  esac
+  AC_MSG_RESULT([$PHP_LIBNAME])
+])
 
 dnl
 dnl PHP_CHECK_LIBRARY(library, function [, action-found [, action-not-found [, extra-libs]]])
@@ -1626,8 +1660,8 @@
       if test -r $i/include/openssl/evp.h; then
         OPENSSL_INCDIR=$i/include
       fi
-      if test -r $i/lib/libssl.a -o -r $i/lib/libssl.$SHLIB_SUFFIX_NAME; then
-        OPENSSL_LIBDIR=$i/lib
+      if test -r $i/$PHP_LIBNAME/libssl.a -o -r $i/$PHP_LIBNAME/libssl.$SHLIB_SUFFIX_NAME; then
+        OPENSSL_LIBDIR=$i/$PHP_LIBNAME
       fi
       test -n "$OPENSSL_INCDIR" && test -n "$OPENSSL_LIBDIR" && break
     done
@@ -1736,8 +1770,8 @@
       AC_MSG_ERROR([Please specify the install prefix of iconv with --with-iconv=<DIR>])
     fi
   
-    if test -f $ICONV_DIR/lib/lib$iconv_lib_name.a ||
-       test -f $ICONV_DIR/lib/lib$iconv_lib_name.$SHLIB_SUFFIX_NAME
+    if test -f $ICONV_DIR/$PHP_LIBNAME/lib$iconv_lib_name.a ||
+       test -f $ICONV_DIR/$PHP_LIBNAME/lib$iconv_lib_name.$SHLIB_SUFFIX_NAME
     then
       PHP_CHECK_LIBRARY($iconv_lib_name, libiconv, [
         found_iconv=yes
@@ -1747,10 +1781,10 @@
           found_iconv=yes
           PHP_DEFINE(HAVE_ICONV)
         ], [], [
-          -L$ICONV_DIR/lib
+          -L$ICONV_DIR/$PHP_LIBNAME
         ])
       ], [
-        -L$ICONV_DIR/lib
+        -L$ICONV_DIR/$PHP_LIBNAME
       ])
     fi
   fi
diff -Naur php-4.3.6/aclocal.m4 php-4.3.6.oden/aclocal.m4
--- php-4.3.6/aclocal.m4	2004-04-14 17:04:40.000000000 +0200
+++ php-4.3.6.oden/aclocal.m4	2004-05-21 14:02:28.240683816 +0200
@@ -180,7 +180,7 @@
   unset ac_new_flags
   for i in [$]$1; do
     case [$]i in
-    -L/usr/lib|-L/usr/lib/[)] ;;
+    -L/usr/lib|-L/usr/lib/|-L/usr/lib64|-L/usr/lib64/) ;;
     *[)] ac_new_flags="[$]ac_new_flags [$]i" ;;
     esac
   done
@@ -836,7 +836,7 @@
 dnl add a library to linkpath/runpath
 dnl
 AC_DEFUN([PHP_ADD_LIBPATH],[
-  if test "$1" != "/usr/lib"; then
+  if test "$1" != "/usr/lib" && test "$1" != "/usr/lib64"; then
     PHP_EXPAND_PATH($1, ai_p)
     ifelse([$2],,[
       _PHP_ADD_LIBPATH_GLOBAL([$ai_p])
@@ -1539,6 +1539,41 @@
   	fi
 ])
 
+dnl
+dnl PHP_CHECK_LIBNAME
+dnl
+dnl Determine libdir name.
+dnl
+AC_DEFUN([PHP_CHECK_LIBNAME], [
+  AC_REQUIRE([AC_CANONICAL_HOST])dnl
+  AC_REQUIRE([AC_CANONICAL_BUILD])dnl
+  AC_MSG_CHECKING([libdir name])
+  case $host in
+  *-*-linux*)
+ # Test if the compiler is 64bit
+ echo 'int i;' > conftest.$ac_ext
+ php_cv_cc_64bit_output=no
+ if AC_TRY_EVAL(ac_compile); then
+   case `/usr/bin/file conftest.$ac_objext` in
+   *"ELF 64"*)
+     php_cv_cc_64bit_output=yes
+     ;;
+   esac
+ fi
+ rm -rf conftest*
+ ;;
+  esac
+  
+  case $host_cpu:$php_cv_cc_64bit_output in
+  powerpc64:yes | s390x:yes | sparc64:yes | x86_64:yes)
+ PHP_LIBNAME="lib64"
+ ;;
+  *:*)
+ PHP_LIBNAME="lib"
+ ;;
+  esac
+  AC_MSG_RESULT([$PHP_LIBNAME])
+])
 
 dnl
 dnl PHP_CHECK_LIBRARY(library, function [, action-found [, action-not-found [, extra-libs]]])
@@ -1626,8 +1661,8 @@
       if test -r $i/include/openssl/evp.h; then
         OPENSSL_INCDIR=$i/include
       fi
-      if test -r $i/lib/libssl.a -o -r $i/lib/libssl.$SHLIB_SUFFIX_NAME; then
-        OPENSSL_LIBDIR=$i/lib
+      if test -r $i/$PHP_LIBNAME/libssl.a -o -r $i/$PHP_LIBNAME/libssl.$SHLIB_SUFFIX_NAME; then
+        OPENSSL_LIBDIR=$i/$PHP_LIBNAME
       fi
       test -n "$OPENSSL_INCDIR" && test -n "$OPENSSL_LIBDIR" && break
     done
@@ -1736,8 +1771,8 @@
       AC_MSG_ERROR([Please specify the install prefix of iconv with --with-iconv=<DIR>])
     fi
   
-    if test -f $ICONV_DIR/lib/lib$iconv_lib_name.a ||
-       test -f $ICONV_DIR/lib/lib$iconv_lib_name.$SHLIB_SUFFIX_NAME
+    if test -f $ICONV_DIR/$PHP_LIBNAME/lib$iconv_lib_name.a ||
+       test -f $ICONV_DIR/$PHP_LIBNAME/lib$iconv_lib_name.$SHLIB_SUFFIX_NAME
     then
       PHP_CHECK_LIBRARY($iconv_lib_name, libiconv, [
         found_iconv=yes
@@ -1747,10 +1782,10 @@
           found_iconv=yes
           PHP_DEFINE(HAVE_ICONV)
         ], [], [
-          -L$ICONV_DIR/lib
+          -L$ICONV_DIR/$PHP_LIBNAME
         ])
       ], [
-        -L$ICONV_DIR/lib
+        -L$ICONV_DIR/$PHP_LIBNAME
       ])
     fi
   fi
diff -Naur php-4.3.6/configure.in php-4.3.6.oden/configure.in
--- php-4.3.6/configure.in	2004-04-14 17:00:35.000000000 +0200
+++ php-4.3.6.oden/configure.in	2004-05-21 14:02:28.249682448 +0200
@@ -128,6 +128,10 @@
 PHP_RUNPATH_SWITCH
 
 PHP_PROG_RE2C
+
+dnl check for libdir name
+PHP_CHECK_LIBNAME
+
 AC_PROG_RANLIB
 AC_PROG_LN_S
 AC_PROG_AWK
diff -Naur php-4.3.6/ext/cpdf/config.m4 php-4.3.6.oden/ext/cpdf/config.m4
--- php-4.3.6/ext/cpdf/config.m4	2003-10-01 04:53:53.000000000 +0200
+++ php-4.3.6.oden/ext/cpdf/config.m4	2004-05-21 14:02:28.253681840 +0200
@@ -4,7 +4,7 @@
   AC_ARG_WITH(jpeg-dir,
   [  --with-jpeg-dir[=DIR]     CPDF: Set the path to libjpeg install prefix.],[
     for i in $withval /usr/local /usr; do
-      if test -f "$i/lib/libjpeg.$SHLIB_SUFFIX_NAME" -o -f "$i/lib/libjpeg.a"; then
+      if test -f "$i/$PHP_LIBNAME/libjpeg.$SHLIB_SUFFIX_NAME" -o -f "$i/$PHP_LIBNAME/libjpeg.a"; then
         CPDF_JPEG_DIR=$i
         break;
       fi
@@ -14,11 +14,11 @@
       AC_MSG_ERROR([libjpeg.(a|so) not found.])
     fi
     PHP_CHECK_LIBRARY(jpeg, jpeg_read_header, [
-      PHP_ADD_LIBRARY_WITH_PATH(jpeg, $CPDF_JPEG_DIR/lib, CPDF_SHARED_LIBADD)
+      PHP_ADD_LIBRARY_WITH_PATH(jpeg, $CPDF_JPEG_DIR/$PHP_LIBNAME, CPDF_SHARED_LIBADD)
     ] ,[
       AC_MSG_ERROR([CPDF: Problem with libjpeg.(a|so). Please check config.log for more information.])
     ], [
-      -L$CPDF_JPEG_DIR/lib
+      -L$CPDF_JPEG_DIR/$PHP_LIBNAME
     ])
   ],)
 ])
@@ -27,7 +27,7 @@
   AC_ARG_WITH(tiff-dir,
   [  --with-tiff-dir[=DIR]     CPDF: Set the path to libtiff install prefix.],[
     for i in $withval /usr/local /usr; do
-      if test -f "$i/lib/libtiff.$SHLIB_SUFFIX_NAME" -o -f "$i/lib/libtiff.a"; then
+      if test -f "$i/$PHP_LIBNAME/libtiff.$SHLIB_SUFFIX_NAME" -o -f "$i/$PHP_LIBNAME/libtiff.a"; then
         CPDF_TIFF_DIR=$i
         break;
       fi
@@ -37,11 +37,11 @@
       AC_MSG_ERROR([libtiff.(a|so) not found.])
     fi
     PHP_CHECK_LIBRARY(tiff, TIFFOpen, [
-      PHP_ADD_LIBRARY_WITH_PATH(tiff, $CPDF_TIFF_DIR/lib, CPDF_SHARED_LIBADD)
+      PHP_ADD_LIBRARY_WITH_PATH(tiff, $CPDF_TIFF_DIR/$PHP_LIBNAME, CPDF_SHARED_LIBADD)
     ] ,[
       AC_MSG_ERROR([CPDF: Problem with libtiff.(a|so). Please check config.log for more information.])
     ], [
-      -L$CPDF_TIFF_DIR/lib
+      -L$CPDF_TIFF_DIR/$PHP_LIBNAME
     ])
   ],)
 ])
@@ -66,12 +66,12 @@
 
         PHP_CHECK_LIBRARY(cpdf, cpdf_open, [
           PHP_ADD_INCLUDE($CPDFLIB_INCLUDE)
-          PHP_ADD_LIBRARY_WITH_PATH(cpdf, $i/lib, CPDF_SHARED_LIBADD)
+          PHP_ADD_LIBRARY_WITH_PATH(cpdf, $i/$PHP_LIBNAME, CPDF_SHARED_LIBADD)
           AC_DEFINE(HAVE_CPDFLIB,1,[Whether you have cpdflib])
         ], [
           AC_MSG_ERROR([Cpdflib module requires cpdflib >= 2.])
         ], [
-          -L$i/lib $CPDF_SHARED_LIBADD
+          -L$i/$PHP_LIBNAME $CPDF_SHARED_LIBADD
         ])
         break
       fi
diff -Naur php-4.3.6/ext/cyrus/config.m4 php-4.3.6.oden/ext/cyrus/config.m4
--- php-4.3.6/ext/cyrus/config.m4	2003-10-03 07:25:32.000000000 +0200
+++ php-4.3.6.oden/ext/cyrus/config.m4	2004-05-21 14:02:28.253681840 +0200
@@ -50,10 +50,10 @@
     fi
 
     if test "$found_sasl" = "yes"; then
-      if test -f $i/lib/libsasl2.a || test -f $i/lib/libsasl2.$SHLIB_SUFFIX_NAME; then
-        PHP_ADD_LIBRARY_WITH_PATH(sasl2, $i/lib, CYRUS_SHARED_LIBADD)
+      if test -f $i/$PHP_LIBDIR/libsasl2.a || test -f $i/$PHP_LIBDIR/libsasl2.$SHLIB_SUFFIX_NAME; then
+        PHP_ADD_LIBRARY_WITH_PATH(sasl2, $i/$PHP_LIBDIR, CYRUS_SHARED_LIBADD)
       else
-        PHP_ADD_LIBRARY_WITH_PATH(sasl, $i/lib, CYRUS_SHARED_LIBADD)
+        PHP_ADD_LIBRARY_WITH_PATH(sasl, $i/$PHP_LIBDIR, CYRUS_SHARED_LIBADD)
       fi
       break 2
     fi
@@ -70,8 +70,8 @@
   if test "$PHP_OPENSSL" = "no"; then
     for i in $PHP_CYRUS /usr/local /usr; do
       if test -r $i/include/openssl/ssl.h; then
-        PHP_ADD_LIBRARY_WITH_PATH(ssl, $i/lib, CYRUS_SHARED_LIBADD)
-        PHP_ADD_LIBRARY_WITH_PATH(crypto, $i/lib, CYRUS_SHARED_LIBADD)
+        PHP_ADD_LIBRARY_WITH_PATH(ssl, $i/$PHP_LIBDIR, CYRUS_SHARED_LIBADD)
+        PHP_ADD_LIBRARY_WITH_PATH(crypto, $i/$PHP_LIBDIR, CYRUS_SHARED_LIBADD)
         break 2
       fi
     done
diff -Naur php-4.3.6/ext/domxml/config.m4 php-4.3.6.oden/ext/domxml/config.m4
--- php-4.3.6/ext/domxml/config.m4	2002-10-30 18:42:36.000000000 +0100
+++ php-4.3.6.oden/ext/domxml/config.m4	2004-05-21 14:02:28.254681688 +0200
@@ -50,7 +50,7 @@
 
   PHP_DOM_CHECK_VERSION
 
-  if test -f $DOMXML_DIR/lib/libxml2.a -o -f $DOMXML_DIR/lib/libxml2.$SHLIB_SUFFIX_NAME ; then
+  if test -f $DOMXML_DIR/$PHP_LIBNAME/libxml2.a -o -f $DOMXML_DIR/$PHP_LIBNAME/libxml2.$SHLIB_SUFFIX_NAME ; then
     DOM_LIBNAME=xml2
   else
     DOM_LIBNAME=xml
@@ -62,7 +62,7 @@
     DOM_LIBS=`$XML2_CONFIG --libs`
     PHP_EVAL_LIBLINE($DOM_LIBS, DOMXML_SHARED_LIBADD)
   else 
-    PHP_ADD_LIBRARY_WITH_PATH($DOM_LIBNAME, $DOMXML_DIR/lib, DOMXML_SHARED_LIBADD)
+    PHP_ADD_LIBRARY_WITH_PATH($DOM_LIBNAME, $DOMXML_DIR/$PHP_LIBNAME, DOMXML_SHARED_LIBADD)
   fi
 
   PHP_ADD_INCLUDE($DOMXML_DIR/include$DOMXML_DIR_ADD)
@@ -70,7 +70,7 @@
   if test "$PHP_ZLIB_DIR" = "no"; then
     AC_MSG_ERROR(DOMXML requires ZLIB. Use --with-zlib-dir=<DIR>)
   else
-    PHP_ADD_LIBRARY_WITH_PATH(z, $PHP_ZLIB_DIR/lib, DOMXML_SHARED_LIBADD)
+    PHP_ADD_LIBRARY_WITH_PATH(z, $PHP_ZLIB_DIR/$PHP_LIBNAME, DOMXML_SHARED_LIBADD)
   fi
   
   AC_DEFINE(HAVE_DOMXML,1,[ ])
@@ -137,7 +137,7 @@
 
   PHP_DOM_XSLT_CHECK_VERSION
 
-  PHP_ADD_LIBRARY_WITH_PATH(xslt, $DOMXSLT_DIR/lib, DOMXML_SHARED_LIBADD)
+  PHP_ADD_LIBRARY_WITH_PATH(xslt, $DOMXSLT_DIR/$PHP_LIBNAME, DOMXML_SHARED_LIBADD)
 
   PHP_ADD_INCLUDE($DOMXSLT_DIR/include)
 
@@ -145,17 +145,17 @@
     AC_MSG_ERROR(DOMXSLT requires DOMXML. Use --with-dom=<DIR>)
   fi
   
-  if test -f $DOMXML_DIR/lib/libxml2.a -o -f $DOMXML_DIR/lib/libxml2.$SHLIB_SUFFIX_NAME ; then
+  if test -f $DOMXML_DIR/$PHP_LIBNAME/libxml2.a -o -f $DOMXML_DIR/$PHP_LIBNAME/libxml2.$SHLIB_SUFFIX_NAME ; then
     DOM_LIBNAME=xml2
   else
     DOM_LIBNAME=xml
   fi
 
-  PHP_ADD_LIBRARY_WITH_PATH($DOM_LIBNAME, $DOMXML_DIR/lib, DOMXML_SHARED_LIBADD)
+  PHP_ADD_LIBRARY_WITH_PATH($DOM_LIBNAME, $DOMXML_DIR/$PHP_LIBNAME, DOMXML_SHARED_LIBADD)
   PHP_ADD_INCLUDE($DOMXML_DIR/include$DOMXML_DIR_ADD)
 
-  if test -f $DOMXML_DIR/lib/libxsltbreakpoint.a -o -f $DOMXML_DIR/lib/libxsltbreakpoint.$SHLIB_SUFFIX_NAME ; then
-    PHP_ADD_LIBRARY_WITH_PATH(xsltbreakpoint, $DOMXML_DIR/lib, DOMXML_SHARED_LIBADD)
+  if test -f $DOMXML_DIR/$PHP_LIBNAME/libxsltbreakpoint.a -o -f $DOMXML_DIR/$PHP_LIBNAME/libxsltbreakpoint.$SHLIB_SUFFIX_NAME ; then
+    PHP_ADD_LIBRARY_WITH_PATH(xsltbreakpoint, $DOMXML_DIR/$PHP_LIBNAME, DOMXML_SHARED_LIBADD)
   fi
 
   AC_DEFINE(HAVE_DOMXSLT,1,[ ])
@@ -187,7 +187,7 @@
 
   PHP_DOM_EXSLT_CHECK_VERSION
 
-  PHP_ADD_LIBRARY_WITH_PATH(exslt, $DOMEXSLT_DIR/lib, DOMXML_SHARED_LIBADD)
+  PHP_ADD_LIBRARY_WITH_PATH(exslt, $DOMEXSLT_DIR/$PHP_LIBNAME, DOMXML_SHARED_LIBADD)
 
   PHP_ADD_INCLUDE($DOMEXSLT_DIR/include)
 
diff -Naur php-4.3.6/ext/fbsql/config.m4 php-4.3.6.oden/ext/fbsql/config.m4
--- php-4.3.6/ext/fbsql/config.m4	2003-10-01 04:53:55.000000000 +0200
+++ php-4.3.6.oden/ext/fbsql/config.m4	2004-05-21 14:02:28.254681688 +0200
@@ -33,11 +33,11 @@
     fi
   fi  
 
-  if test ! -r "$FBSQL_INSTALLATION_DIR/lib/libFBCAccess.a"; then
-     AC_MSG_ERROR(Could not find $FBSQL_INSTALLATION_DIR/lib/libFBCAccess.a)
+  if test ! -r "$FBSQL_INSTALLATION_DIR/$PHP_LIBDIR/libFBCAccess.a"; then
+     AC_MSG_ERROR(Could not find $FBSQL_INSTALLATION_DIR/$PHP_LIBDIR/libFBCAccess.a)
   fi
 
-  PHP_ADD_LIBRARY_WITH_PATH(FBCAccess, $FBSQL_INSTALLATION_DIR/lib, FBSQL_SHARED_LIBADD)
+  PHP_ADD_LIBRARY_WITH_PATH(FBCAccess, $FBSQL_INSTALLATION_DIR/$PHP_LIBDIR, FBSQL_SHARED_LIBADD)
   PHP_ADD_INCLUDE($FBSQL_INSTALLATION_DIR/include)
   PHP_SUBST(FBSQL_SHARED_LIBADD)
 fi
diff -Naur php-4.3.6/ext/gd/config.m4 php-4.3.6.oden/ext/gd/config.m4
--- php-4.3.6/ext/gd/config.m4	2003-12-25 23:33:02.000000000 +0100
+++ php-4.3.6.oden/ext/gd/config.m4	2004-05-21 14:02:28.250682296 +0200
@@ -51,7 +51,7 @@
   if test "$PHP_JPEG_DIR" != "no"; then
 
     for i in $PHP_JPEG_DIR /usr/local /usr; do
-      test -f $i/lib/libjpeg.$SHLIB_SUFFIX_NAME -o -f $i/lib/libjpeg.a && GD_JPEG_DIR=$i && break
+      test -f $i/$PHP_LIBNAME/libjpeg.$SHLIB_SUFFIX_NAME -o -f $i/$PHP_LIBNAME/libjpeg.a && GD_JPEG_DIR=$i && break
     done
 
     if test -z "$GD_JPEG_DIR"; then
@@ -61,11 +61,11 @@
     PHP_CHECK_LIBRARY(jpeg,jpeg_read_header,
     [
       PHP_ADD_INCLUDE($GD_JPEG_DIR/include)
-      PHP_ADD_LIBRARY_WITH_PATH(jpeg, $GD_JPEG_DIR/lib, GD_SHARED_LIBADD)
+      PHP_ADD_LIBRARY_WITH_PATH(jpeg, $GD_JPEG_DIR/$PHP_LIBNAME, GD_SHARED_LIBADD)
     ],[
       AC_MSG_ERROR([Problem with libjpeg.(a|so). Please check config.log for more information.]) 
     ],[
-      -L$GD_JPEG_DIR/lib
+      -L$GD_JPEG_DIR/$PHP_LIBNAME
     ])
   else 
     AC_MSG_RESULT([If configure fails try --with-jpeg-dir=<DIR>])
@@ -76,7 +76,7 @@
   if test "$PHP_PNG_DIR" != "no"; then
 
     for i in $PHP_PNG_DIR /usr/local /usr; do
-      test -f $i/lib/libpng.$SHLIB_SUFFIX_NAME -o -f $i/lib/libpng.a && GD_PNG_DIR=$i && break
+      test -f $i/$PHP_LIBNAME/libpng.$SHLIB_SUFFIX_NAME -o -f $i/$PHP_LIBNAME/libpng.a && GD_PNG_DIR=$i && break
     done
 
     if test -z "$GD_PNG_DIR"; then
@@ -94,12 +94,12 @@
     PHP_CHECK_LIBRARY(png,png_write_image,
     [
       PHP_ADD_INCLUDE($GD_PNG_DIR/include)
-      PHP_ADD_LIBRARY_WITH_PATH(z, $PHP_ZLIB_DIR/lib, GD_SHARED_LIBADD)
-      PHP_ADD_LIBRARY_WITH_PATH(png, $GD_PNG_DIR/lib, GD_SHARED_LIBADD)
+      PHP_ADD_LIBRARY_WITH_PATH(z, $PHP_ZLIB_DIR/$PHP_LIBNAME, GD_SHARED_LIBADD)
+      PHP_ADD_LIBRARY_WITH_PATH(png, $GD_PNG_DIR/$PHP_LIBNAME, GD_SHARED_LIBADD)
     ],[
       AC_MSG_ERROR([Problem with libpng.(a|so) or libz.(a|so). Please check config.log for more information.]) 
     ],[
-      -L$PHP_ZLIB_DIR/lib -lz -L$GD_PNG_DIR/lib
+      -L$PHP_ZLIB_DIR/$PHP_LIBNAME -lz -L$GD_PNG_DIR/$PHP_LIBNAME
     ])
 
   else 
@@ -111,7 +111,7 @@
   if test "$PHP_XPM_DIR" != "no"; then
 
     for i in $PHP_XPM_DIR /usr/local /usr/X11R6 /usr; do
-      test -f $i/lib/libXpm.$SHLIB_SUFFIX_NAME -o -f $i/lib/libXpm.a && GD_XPM_DIR=$i && break
+      test -f $i/$PHP_LIBNAME/libXpm.$SHLIB_SUFFIX_NAME -o -f $i/$PHP_LIBNAME/libXpm.a && GD_XPM_DIR=$i && break
     done
 
     if test -z "$GD_XPM_DIR"; then
@@ -129,12 +129,12 @@
     PHP_CHECK_LIBRARY(Xpm,XpmFreeXpmImage, 
     [
       PHP_ADD_INCLUDE($GD_XPM_INC)
-      PHP_ADD_LIBRARY_WITH_PATH(Xpm, $GD_XPM_DIR/lib, GD_SHARED_LIBADD)
-      PHP_ADD_LIBRARY_WITH_PATH(X11, $GD_XPM_DIR/lib, GD_SHARED_LIBADD)
+      PHP_ADD_LIBRARY_WITH_PATH(Xpm, $GD_XPM_DIR/$PHP_LIBNAME, GD_SHARED_LIBADD)
+      PHP_ADD_LIBRARY_WITH_PATH(X11, $GD_XPM_DIR/$PHP_LIBNAME, GD_SHARED_LIBADD)
     ],[
       AC_MSG_ERROR([Problem with libXpm.(a|so) or libX11.(a|so). Please check config.log for more information.]) 
     ],[
-      -L$GD_XPM_DIR/lib -lX11
+      -L$GD_XPM_DIR/$PHP_LIBNAME -lX11
     ])
   else 
     AC_MSG_RESULT(If configure fails try --with-xpm-dir=<DIR>)
@@ -163,7 +163,7 @@
       fi
       if test -n "$TTF_DIR" ; then
         AC_DEFINE(HAVE_LIBTTF,1,[ ])
-        PHP_ADD_LIBRARY_WITH_PATH(ttf, $TTF_DIR/lib, GD_SHARED_LIBADD)
+        PHP_ADD_LIBRARY_WITH_PATH(ttf, $TTF_DIR/$PHP_LIBNAME, GD_SHARED_LIBADD)
       fi
       if test -z "$TTF_INC_DIR"; then
         TTF_INC_DIR=$TTF_DIR/include
@@ -187,7 +187,7 @@
     done
     
     if test -n "$FREETYPE2_DIR" ; then
-      PHP_ADD_LIBRARY_WITH_PATH(freetype, $FREETYPE2_DIR/lib, GD_SHARED_LIBADD)
+      PHP_ADD_LIBRARY_WITH_PATH(freetype, $FREETYPE2_DIR/$PHP_LIBNAME, GD_SHARED_LIBADD)
       PHP_ADD_INCLUDE($FREETYPE2_DIR/include)
       PHP_ADD_INCLUDE($FREETYPE2_INC_DIR)
       AC_DEFINE(USE_GD_IMGSTRTTF, 1, [ ])
@@ -215,11 +215,11 @@
     [
       AC_DEFINE(HAVE_LIBT1,1,[ ])
       PHP_ADD_INCLUDE($GD_T1_DIR/include)
-      PHP_ADD_LIBRARY_WITH_PATH(t1, $GD_T1_DIR/lib, GD_SHARED_LIBADD)
+      PHP_ADD_LIBRARY_WITH_PATH(t1, $GD_T1_DIR/$PHP_LIBNAME, GD_SHARED_LIBADD)
     ],[
       AC_MSG_ERROR([Problem with libt1.(a|so). Please check config.log for more information.]) 
     ],[
-      -L$GD_T1_DIR/lib
+      -L$GD_T1_DIR/$PHP_LIBNAME
     ])
   fi
 ])
@@ -359,7 +359,7 @@
   done
 
 dnl Library path
-  for i in lib/gd1.3 lib/gd lib gd1.3 gd ""; do
+  for i in lib/gd1.3 lib/gd $PHP_LIBNAME gd1.3 gd ""; do
     test -f "$PHP_GD/$i/libgd.$SHLIB_SUFFIX_NAME" -o -f "$PHP_GD/$i/libgd.a" && GD_LIB="$PHP_GD/$i"
   done
 
diff -Naur php-4.3.6/ext/gettext/config.m4 php-4.3.6.oden/ext/gettext/config.m4
--- php-4.3.6/ext/gettext/config.m4	2003-10-01 04:53:58.000000000 +0200
+++ php-4.3.6.oden/ext/gettext/config.m4	2004-05-21 14:02:28.250682296 +0200
@@ -14,7 +14,7 @@
     AC_MSG_ERROR(Cannot locate header file libintl.h)
   fi
 
-  GETTEXT_LIBDIR=$GETTEXT_DIR/lib
+  GETTEXT_LIBDIR=$GETTEXT_DIR/$PHP_LIBNAME
   GETTEXT_INCDIR=$GETTEXT_DIR/include
   
   O_LDFLAGS=$LDFLAGS
diff -Naur php-4.3.6/ext/imap/config.m4 php-4.3.6.oden/ext/imap/config.m4
--- php-4.3.6/ext/imap/config.m4	2004-01-17 01:01:06.000000000 +0100
+++ php-4.3.6.oden/ext/imap/config.m4	2004-05-21 14:02:28.251682144 +0200
@@ -71,7 +71,7 @@
     fi
 
     for i in $SEARCH_PATHS; do
-      if test -f $i/lib/libkrb5.a || test -f $i/lib/libkrb5.$SHLIB_SUFFIX_NAME; then
+      if test -f $i/$PHP_LIBNAME/libkrb5.a || test -f $i/$PHP_LIBNAME/libkrb5.$SHLIB_SUFFIX_NAME; then
         PHP_KERBEROS_DIR=$i
         break
       fi
@@ -84,7 +84,7 @@
       ])
     fi
     AC_DEFINE(HAVE_IMAP_KRB,1,[ ])
-    PHP_ADD_LIBPATH($PHP_KERBEROS_DIR/lib, IMAP_SHARED_LIBADD)
+    PHP_ADD_LIBPATH($PHP_KERBEROS_DIR/$PHP_LIBNAME, IMAP_SHARED_LIBADD)
     PHP_ADD_LIBRARY(gssapi_krb5, 1, IMAP_SHARED_LIBADD)
     PHP_ADD_LIBRARY(krb5, 1, IMAP_SHARED_LIBADD)
     PHP_ADD_LIBRARY(k5crypto, 1, IMAP_SHARED_LIBADD)
@@ -116,11 +116,11 @@
   AC_MSG_CHECKING([whether SSL libraries are needed for c-client])
 
   if test "$PHP_IMAP_SSL" != "no"; then
-    AC_MSG_RESULT([$PHP_IMAP_SSL/lib])
+    AC_MSG_RESULT([$PHP_IMAP_SSL/$PHP_LIBNAME])
     AC_DEFINE(HAVE_IMAP_SSL,1,[ ])
     PHP_ADD_LIBRARY_DEFER(ssl,    1, IMAP_SHARED_LIBADD)
     PHP_ADD_LIBRARY_DEFER(crypto, 1, IMAP_SHARED_LIBADD)
-    PHP_ADD_LIBPATH($PHP_IMAP_SSL/lib, IMAP_SHARED_LIBADD)
+    PHP_ADD_LIBPATH($PHP_IMAP_SSL/$PHP_LIBNAME, IMAP_SHARED_LIBADD)
   else
     AC_MSG_RESULT(no)
   fi
@@ -184,7 +184,7 @@
 
     for lib in c-client4 c-client imap; do
       IMAP_LIB=$lib
-      IMAP_LIB_CHK(lib)
+      IMAP_LIB_CHK($PHP_LIBNAME)
       IMAP_LIB_CHK(c-client)
     done
 
diff -Naur php-4.3.6/ext/ldap/config.m4 php-4.3.6.oden/ext/ldap/config.m4
--- php-4.3.6/ext/ldap/config.m4	2003-07-01 02:02:29.000000000 +0200
+++ php-4.3.6.oden/ext/ldap/config.m4	2004-05-21 14:02:28.251682144 +0200
@@ -6,7 +6,7 @@
   if test -f $1/include/ldap.h; then
     LDAP_DIR=$1
     LDAP_INCDIR=$1/include
-    LDAP_LIBDIR=$1/lib
+    LDAP_LIBDIR=$1/$PHP_LIBNAME
   elif test -f $1/include/umich-ldap/ldap.h; then
     LDAP_DIR=$1
     LDAP_INCDIR=$1/include/umich-ldap
diff -Naur php-4.3.6/ext/mcal/config.m4 php-4.3.6.oden/ext/mcal/config.m4
--- php-4.3.6/ext/mcal/config.m4	2002-03-27 11:26:16.000000000 +0100
+++ php-4.3.6.oden/ext/mcal/config.m4	2004-05-21 14:02:28.255681536 +0200
@@ -19,7 +19,7 @@
     fi
   done
 
-  for i in $MCAL_DIR $MCAL_DIR/mcal $MCAL_DIR/mcal/lib $MCAL_DIR/lib/mcal $MCAL_DIR/lib; do
+  for i in $MCAL_DIR $MCAL_DIR/mcal $MCAL_DIR/mcal/$PHP_LIBDIR $MCAL_DIR/$PHP_LIBDIR/mcal $MCAL_DIR/$PHP_LIBDIR; do
     if test -r "$i/libmcal.a"; then
       MCAL_LIBRARY=$i
     fi
diff -Naur php-4.3.6/ext/ming/config.m4 php-4.3.6.oden/ext/ming/config.m4
--- php-4.3.6/ext/ming/config.m4	2003-07-11 09:48:33.000000000 +0200
+++ php-4.3.6.oden/ext/ming/config.m4	2004-05-21 14:02:28.255681536 +0200
@@ -9,7 +9,7 @@
   AC_CHECK_LIB(m, sin)
 
   for i in $PHP_MING /usr/local /usr; do
-    if test -f $i/lib/libming.$SHLIB_SUFFIX_NAME -o -f $i/lib/libming.a; then
+    if test -f $i/$PHP_LIBDIR/libming.$SHLIB_SUFFIX_NAME -o -f $i/$PHP_LIBDIR/libming.a; then
       MING_DIR=$i
     fi
   done
@@ -33,11 +33,11 @@
   ],[
     AC_MSG_ERROR([Ming library 0.2a or greater required.])
   ],[
-    -L$MING_DIR/lib
+    -L$MING_DIR/$PHP_LIBDIR
   ])
   
   PHP_ADD_INCLUDE($MING_INC_DIR)
-  PHP_ADD_LIBRARY_WITH_PATH(ming, $MING_DIR/lib, MING_SHARED_LIBADD)
+  PHP_ADD_LIBRARY_WITH_PATH(ming, $MING_DIR/$PHP_LIBDIR, MING_SHARED_LIBADD)
 
   AC_MSG_CHECKING([for destroySWFBlock])
   AC_TRY_RUN([
diff -Naur php-4.3.6/ext/msession/config.m4 php-4.3.6.oden/ext/msession/config.m4
--- php-4.3.6/ext/msession/config.m4	2002-03-12 17:25:11.000000000 +0100
+++ php-4.3.6.oden/ext/msession/config.m4	2004-05-21 14:02:28.255681536 +0200
@@ -6,12 +6,12 @@
 [  --with-msession[=DIR]   Include msession support])
  
 if test "$PHP_MSESSION" != "no"; then
-	if test -r $PHP_MSESSION/lib/libphoenix.a; then
+	if test -r $PHP_MSESSION/$PHP_LIBNAME/libphoenix.a; then
 		PHOENIX_DIR=$PHP_MSESSION
 	else
 		AC_MSG_CHECKING(for msession in default path)
 		for i in /usr/local/phoenix /usr/local /usr; do
-			if test -r $i/lib/libphoenix.a; then
+			if test -r $i/$PHP_LIBNAME/libphoenix.a; then
 				PHOENIX_DIR=$i
 				AC_MSG_RESULT(found in $i)
 			fi
@@ -25,7 +25,7 @@
 
 
   	AC_DEFINE(HAVE_MSESSION, 1, [ ])
-  	PHP_ADD_LIBRARY_WITH_PATH(phoenix, "$PHOENIX_DIR/lib", PHOENIX_LIB)
+  	PHP_ADD_LIBRARY_WITH_PATH(phoenix, "$PHOENIX_DIR/$PHP_LIBNAME", PHOENIX_LIB)
 	PHOENIX_INCLUDE="-I$PHOENIX_DIR"
 	PHP_SUBST(PHOENIX_LIB)
 
diff -Naur php-4.3.6/ext/mssql/config.m4 php-4.3.6.oden/ext/mssql/config.m4
--- php-4.3.6/ext/mssql/config.m4	2003-02-09 08:48:40.000000000 +0100
+++ php-4.3.6.oden/ext/mssql/config.m4	2004-05-21 14:02:28.256681384 +0200
@@ -32,12 +32,12 @@
     fi
   fi  
 
-  if test ! -r "$FREETDS_INSTALLATION_DIR/lib/libtds.a"; then
-     AC_MSG_ERROR(Could not find $FREETDS_INSTALLATION_DIR/lib/libtds.a)
+  if test ! -r "$FREETDS_INSTALLATION_DIR/$PHP_LIBDIR/libtds.a"; then
+     AC_MSG_ERROR(Could not find $FREETDS_INSTALLATION_DIR/$PHP_LIBDIR/libtds.a)
   fi
 
   MSSQL_INCDIR=$FREETDS_INSTALLATION_DIR/include
-  MSSQL_LIBDIR=$FREETDS_INSTALLATION_DIR/lib
+  MSSQL_LIBDIR=$FREETDS_INSTALLATION_DIR/$PHP_LIBDIR
 
   PHP_ADD_INCLUDE($MSSQL_INCDIR)
   PHP_ADD_LIBRARY_WITH_PATH(sybdb, $MSSQL_LIBDIR, MSSQL_SHARED_LIBADD)
diff -Naur php-4.3.6/ext/mysql/config.m4 php-4.3.6.oden/ext/mysql/config.m4
--- php-4.3.6/ext/mysql/config.m4	2003-12-31 12:28:38.000000000 +0100
+++ php-4.3.6.oden/ext/mysql/config.m4	2004-05-21 14:02:28.252681992 +0200
@@ -114,7 +114,7 @@
 
   MYSQL_MODULE_TYPE=external
 
-  for i in lib lib/mysql; do
+  for i in $PHP_LIBNAME $PHP_LIBNAME/mysql; do
     MYSQL_LIB_CHK($i)
   done
 
diff -Naur php-4.3.6/ext/odbc/config.m4 php-4.3.6.oden/ext/odbc/config.m4
--- php-4.3.6/ext/odbc/config.m4	2003-11-25 09:08:30.000000000 +0100
+++ php-4.3.6.oden/ext/odbc/config.m4	2004-05-21 14:02:28.256681384 +0200
@@ -423,7 +423,7 @@
   fi
   if test "$withval" != "no"; then
     ODBC_INCDIR=$withval/include
-    ODBC_LIBDIR=$withval/lib
+    ODBC_LIBDIR=$withval/$PHP_LIBDIR
     ODBC_LFLAGS=-L$ODBC_LIBDIR
     ODBC_INCLUDE=-I$ODBC_INCDIR
     ODBC_LIBS=-lodbc
diff -Naur php-4.3.6/ext/pgsql/config.m4 php-4.3.6.oden/ext/pgsql/config.m4
--- php-4.3.6/ext/pgsql/config.m4	2002-06-26 15:07:40.000000000 +0200
+++ php-4.3.6.oden/ext/pgsql/config.m4	2004-05-21 14:02:28.252681992 +0200
@@ -29,7 +29,7 @@
       fi
     done
 
-    for j in lib lib/pgsql lib/postgres lib/postgresql ""; do
+    for j in $PHP_LIBNAME lib/pgsql lib/postgres lib/postgresql ""; do
       if test -f "$i/$j/libpq.so" || test -f "$i/$j/libpq.a"; then 
         PGSQL_LIBDIR=$i/$j
       fi
diff -Naur php-4.3.6/ext/qtdom/config.m4 php-4.3.6.oden/ext/qtdom/config.m4
--- php-4.3.6/ext/qtdom/config.m4	2002-11-18 06:06:37.000000000 +0100
+++ php-4.3.6.oden/ext/qtdom/config.m4	2004-05-21 14:02:28.257681232 +0200
@@ -9,16 +9,16 @@
   case $PHP_QTDOM in
     yes)
       if test -f $QTDIR/include/qdom.h; then
-        QTDOM_LIBDIR=$QTDIR/lib
+        QTDOM_LIBDIR=$QTDIR/$PHP_LIBNAME
         QTDOM_INCDIR=$QTDIR/include
-      elif test -f /usr/lib/qt2/include/qdom.h; then
-        QTDOM_LIBDIR=/usr/lib
-        QTDOM_INCDIR=/usr/lib/qt2/include
+      elif test -f /usr/$PHP_LIBNAME/qt2/include/qdom.h; then
+        QTDOM_LIBDIR=/usr/$PHP_LIBNAME
+        QTDOM_INCDIR=/usr/$PHP_LIBNAME/qt2/include
       fi
       ;;
     *)
       if test -f $PHP_QTDOM/include/qdom.h; then
-        QTDOM_LIBDIR=$PHP_QTDOM/lib
+        QTDOM_LIBDIR=$PHP_QTDOM/$PHP_LIBNAME
         QTDOM_INCDIR=$PHP_QTDOM/include
       fi
       ;;
diff -Naur php-4.3.6/ext/snmp/config.m4 php-4.3.6.oden/ext/snmp/config.m4
--- php-4.3.6/ext/snmp/config.m4	2003-09-23 10:16:47.000000000 +0200
+++ php-4.3.6.oden/ext/snmp/config.m4	2004-05-21 14:02:28.252681992 +0200
@@ -46,12 +46,12 @@
         test -f $i/snmp/include/ucd-snmp/snmp.h && SNMP_INCDIR=$i/snmp/include/ucd-snmp
       done
       for i in /usr /usr/snmp /usr/local /usr/local/snmp; do
-        test -f $i/lib/libsnmp.a -o -f $i/lib/libsnmp.$SHLIB_SUFFIX_NAME && SNMP_LIBDIR=$i/lib
+        test -f $i/$PHP_LIBNAME/libsnmp.a -o -f $i/$PHP_LIBNAME/libsnmp.$SHLIB_SUFFIX_NAME && SNMP_LIBDIR=$i/$PHP_LIBNAME
       done
     else
       SNMP_INCDIR=$PHP_SNMP/include
       test -d $PHP_SNMP/include/ucd-snmp && SNMP_INCDIR=$PHP_SNMP/include/ucd-snmp
-      SNMP_LIBDIR=$PHP_SNMP/lib
+      SNMP_LIBDIR=$PHP_SNMP/$PHP_LIBNAME
     fi
 
     if test -z "$SNMP_INCDIR"; then
diff -Naur php-4.3.6/ext/swf/config.m4 php-4.3.6.oden/ext/swf/config.m4
--- php-4.3.6/ext/swf/config.m4	2002-03-12 17:35:59.000000000 +0100
+++ php-4.3.6.oden/ext/swf/config.m4	2004-05-21 14:02:28.257681232 +0200
@@ -6,12 +6,12 @@
 [  --with-swf[=DIR]        Include swf support])
 
 if test "$PHP_SWF" != "no"; then
-  if test -r $PHP_SWF/lib/libswf.a; then
+  if test -r $PHP_SWF/$PHP_LIBNAME/libswf.a; then
     SWF_DIR=$PHP_SWF
   else
     AC_MSG_CHECKING(for libswf in default path)
     for i in /usr/local /usr; do
-      if test -r $i/lib/libswf.a; then
+      if test -r $i/$PHP_LIBNAME/libswf.a; then
         SWF_DIR=$i
         AC_MSG_RESULT(found in $i)
       fi
@@ -28,7 +28,7 @@
   PHP_ADD_INCLUDE($SWF_DIR/include)
 
   PHP_SUBST(SWF_SHARED_LIBADD)
-  PHP_ADD_LIBRARY_WITH_PATH(swf, $SWF_DIR/lib, SWF_SHARED_LIBADD)
+  PHP_ADD_LIBRARY_WITH_PATH(swf, $SWF_DIR/$PHP_LIBNAME, SWF_SHARED_LIBADD)
   AC_DEFINE(HAVE_SWF,1,[ ])
 
   PHP_NEW_EXTENSION(swf, swf.c, $ext_shared)
diff -Naur php-4.3.6/ext/xml/config.m4 php-4.3.6.oden/ext/xml/config.m4
--- php-4.3.6/ext/xml/config.m4	2003-10-03 07:25:42.000000000 +0200
+++ php-4.3.6.oden/ext/xml/config.m4	2004-05-21 14:02:28.253681840 +0200
@@ -31,7 +31,7 @@
     PHP_NEW_EXTENSION(xml, xml.c, $ext_shared)
 
     for i in $PHP_XML $PHP_EXPAT_DIR; do
-      if test -f $i/lib/libexpat.a -o -f $i/lib/libexpat.$SHLIB_SUFFIX_NAME ; then
+      if test -f $i/$PHP_LIBNAME/libexpat.a -o -f $i/$PHP_LIBNAME/libexpat.$SHLIB_SUFFIX_NAME ; then
         EXPAT_DIR=$i
       fi
     done
@@ -41,7 +41,7 @@
     fi
 
     PHP_ADD_INCLUDE($EXPAT_DIR/include)
-    PHP_ADD_LIBRARY_WITH_PATH(expat, $EXPAT_DIR/lib, XML_SHARED_LIBADD)
+    PHP_ADD_LIBRARY_WITH_PATH(expat, $EXPAT_DIR/$PHP_LIBNAME, XML_SHARED_LIBADD)
     PHP_SUBST(XML_SHARED_LIBADD)
   fi
 fi
diff -Naur php-4.3.6/ext/xmlrpc/config.m4 php-4.3.6.oden/ext/xmlrpc/config.m4
--- php-4.3.6/ext/xmlrpc/config.m4	2003-10-03 07:25:43.000000000 +0200
+++ php-4.3.6.oden/ext/xmlrpc/config.m4	2004-05-21 14:02:28.257681232 +0200
@@ -23,9 +23,9 @@
 
   testval=no
   for i in $PHP_EXPAT_DIR $XMLRPC_DIR /usr/local /usr; do
-    if test -f $i/lib/libexpat.a -o -f $i/lib/libexpat.$SHLIB_SUFFIX_NAME; then
+    if test -f $i/$PHP_LIBNAME/libexpat.a -o -f $i/$PHP_LIBNAME/libexpat.$SHLIB_SUFFIX_NAME; then
       AC_DEFINE(HAVE_LIBEXPAT2,1,[ ])
-      PHP_ADD_LIBRARY_WITH_PATH(expat, $i/lib, XMLRPC_SHARED_LIBADD)
+      PHP_ADD_LIBRARY_WITH_PATH(expat, $i/$PHP_LIBNAME, XMLRPC_SHARED_LIBADD)
       PHP_ADD_INCLUDE($i/include)
       testval=yes
       break
@@ -88,5 +88,5 @@
   fi
 
   PHP_ADD_INCLUDE($XMLRPC_DIR)
-  PHP_ADD_LIBRARY_WITH_PATH(xmlrpc, $XMLRPC_DIR/lib, XMLRPC_SHARED_LIBADD)
+  PHP_ADD_LIBRARY_WITH_PATH(xmlrpc, $XMLRPC_DIR/$PHP_LIBNAME, XMLRPC_SHARED_LIBADD)
 fi
diff -Naur php-4.3.6/scripts/Makefile.frag php-4.3.6.oden/scripts/Makefile.frag
--- php-4.3.6/scripts/Makefile.frag	2003-12-01 17:12:42.000000000 +0100
+++ php-4.3.6.oden/scripts/Makefile.frag	2004-05-21 14:02:28.258681080 +0200
@@ -4,7 +4,7 @@
 #
 
 phpincludedir = $(includedir)/php
-phpbuilddir = $(prefix)/lib/php/build
+phpbuilddir = $(libdir)/php/build
 
 BUILD_FILES = \
 	scripts/phpize.m4 \
diff -Naur php-4.3.6/scripts/phpize.in php-4.3.6.oden/scripts/phpize.in
--- php-4.3.6/scripts/phpize.in	2003-11-14 04:21:15.000000000 +0100
+++ php-4.3.6.oden/scripts/phpize.in	2004-05-21 14:02:28.258681080 +0200
@@ -1,7 +1,7 @@
 #! /bin/sh
 
 prefix='@prefix@'
-phpdir="$prefix/lib/php/build"
+phpdir="@libdir@/php/build"
 includedir="$prefix/include/php"
 builddir="`pwd`"
 
diff -Naur php-4.3.6/scripts/phpize.m4 php-4.3.6.oden/scripts/phpize.m4
--- php-4.3.6/scripts/phpize.m4	2003-09-03 10:07:51.000000000 +0200
+++ php-4.3.6.oden/scripts/phpize.m4	2004-05-21 14:02:28.259680928 +0200
@@ -47,6 +47,7 @@
 AC_PROG_CC_C_O
 
 PHP_RUNPATH_SWITCH
+PHP_CHECK_LIBNAME
 PHP_SHLIB_SUFFIX_NAME
 PHP_WITH_PHP_CONFIG
 
--- php-4.3.9/ext/xslt/config.m4.orig	2004-08-17 23:14:16.000000000 -0600
+++ php-4.3.9/ext/xslt/config.m4	2004-09-29 21:59:13.000000000 -0600
@@ -98,10 +98,10 @@
 
     found_expat=no
     for i in $PHP_EXPAT_DIR $XSLT_DIR /usr/local /usr; do
-      if test -f $i/lib/libexpat.a -o -f $i/lib/libexpat.$SHLIB_SUFFIX_NAME; then
+      if test -f $i/$PHP_LIBDIR/libexpat.a -o -f $i/$PHP_LIBDIR/libexpat.$SHLIB_SUFFIX_NAME; then
         AC_DEFINE(HAVE_LIBEXPAT2, 1, [ ])
         PHP_ADD_INCLUDE($i/include)
-        PHP_ADD_LIBRARY_WITH_PATH(expat, $i/lib, XSLT_SHARED_LIBADD)
+        PHP_ADD_LIBRARY_WITH_PATH(expat, $i/$PHP_LIBDIR, XSLT_SHARED_LIBADD)
         found_expat=yes
         break
       fi
@@ -125,7 +125,7 @@
      
     if test "$PHP_SABLOT_JS" != "no"; then
       for i in $PHP_SABLOT_JS /usr/local /usr; do
-        if test -f $i/lib/libjs.a -o -f $i/lib/libjs.$SHLIB_SUFFIX_NAME; then
+        if test -f $i/$PHP_LIBDIR/libjs.a -o -f $i/$PHP_LIBDIR/libjs.$SHLIB_SUFFIX_NAME; then
           PHP_SABLOT_JS_DIR=$i
           break
         fi
@@ -133,12 +133,12 @@
 
       PHP_CHECK_LIBRARY(js, JS_GetRuntime,
       [
-        PHP_ADD_LIBRARY_WITH_PATH(js, $PHP_SABLOT_JS_DIR/lib, XSLT_SHARED_LIBADD)
-        PHP_SABLOT_JS_LIBS="-L$PHP_SABLOT_JS_DIR/lib -ljs"
+        PHP_ADD_LIBRARY_WITH_PATH(js, $PHP_SABLOT_JS_DIR/$PHP_LIBDIR, XSLT_SHARED_LIBADD)
+        PHP_SABLOT_JS_LIBS="-L$PHP_SABLOT_JS_DIR/$PHP_LIBDIR -ljs"
       ], [
         AC_MSG_ERROR([libjs not found. Please check config.log for more information.])
       ], [
-        -L$PHP_SABLOT_JS_DIR/lib
+        -L$PHP_SABLOT_JS_DIR/$PHP_LIBDIR
       ])
     fi
 
@@ -146,7 +146,7 @@
     [
       AC_DEFINE(HAVE_SABLOT_SET_ENCODING, 1, [ ])
     ], [], [
-      -L$XSLT_DIR/lib $PHP_SABLOT_JS_LIBS
+      -L$XSLT_DIR/$PHP_LIBDIR $PHP_SABLOT_JS_LIBS
     ])
 
     dnl SablotSetOptions implemented in Sablotron CVS > 2002/10/31
@@ -154,14 +154,14 @@
     [
       AC_DEFINE(HAVE_SABLOT_GET_OPTIONS, 1, [Whether Sablotron supports SablotGetOptions])
     ], [], [
-      -L$XSLT_DIR/lib $PHP_SABLOT_JS_LIBS
+      -L$XSLT_DIR/$PHP_LIBDIR $PHP_SABLOT_JS_LIBS
     ])
 
     AC_DEFINE(HAVE_SABLOT_BACKEND, 1, [ ])
   fi
 
   PHP_ADD_INCLUDE($XSLT_DIR/include)
-  PHP_ADD_LIBRARY_WITH_PATH($XSLT_LIBNAME, $XSLT_DIR/lib, XSLT_SHARED_LIBADD)
+  PHP_ADD_LIBRARY_WITH_PATH($XSLT_LIBNAME, $XSLT_DIR/$PHP_LIBDIR, XSLT_SHARED_LIBADD)
 
   AC_DEFINE(HAVE_XSLT, 1, [ ])
 fi
