--- linux-2.4.22/drivers/char/drm/Config.in~	2003-09-06 23:36:28.000000000 +0200
+++ linux-2.4.22/drivers/char/drm/Config.in	2003-09-06 23:56:48.000000000 +0200
@@ -10,7 +10,6 @@ tristate '  3dlabs GMX 2000' CONFIG_DRM_
 tristate '  ATI Rage 128' CONFIG_DRM_R128
 tristate '  ATI Radeon' CONFIG_DRM_RADEON
 dep_tristate '  Intel I810' CONFIG_DRM_I810 $CONFIG_AGP
-dep_mbool    '    Enabled XFree 4.1 ioctl interface by default' CONFIG_DRM_I810_XFREE_41 $CONFIG_DRM_I810
 dep_tristate '  Intel 830M' CONFIG_DRM_I830 $CONFIG_AGP
 dep_tristate '  Matrox g200/g400' CONFIG_DRM_MGA $CONFIG_AGP
 dep_tristate '  S3 Savage' CONFIG_DRM_SAVAGE $CONFIG_AGP
--- linux-2.4.22/drivers/char/drm/i810_dma.c~	2003-09-06 23:36:28.000000000 +0200
+++ linux-2.4.22/drivers/char/drm/i810_dma.c	2003-09-06 23:57:31.000000000 +0200
@@ -469,15 +469,6 @@ static int i810_dma_initialize(drm_devic
    	return 0;
 }
 
-#ifdef CONFIG_DRM_I810_XFREE_41
-int xfreeversion = 41;
-#else
-int xfreeversion = -1;
-#endif
-
-MODULE_PARM(xfreeversion, "i");
-MODULE_PARM_DESC(xfreeversion, "The version of XFree86 that needs to be supported");
-
 int i810_dma_init(struct inode *inode, struct file *filp,
 		  unsigned int cmd, unsigned long arg)
 {
@@ -490,28 +481,6 @@ int i810_dma_init(struct inode *inode, s
   	if (copy_from_user(&init, (drm_i810_init_t *)arg, sizeof(init)))
 		return -EFAULT;
 		
-	if ((xfreeversion == 41) ||
-	    ((xfreeversion == -1) && (init.pitch == 0))) {
-		/*
-		 * Ok we have a problem here.  Someone decided it was
-		 * funny to add two fields in the middle of the
-		 * drm_i810_init_it structure in the transition between
-		 * XFree86 4.1.0 and 4.2.0.
-		 *
-		 * The code below tries to fix this ABI breakage up as
-		 * good as possible, unfortionatly it's impossible to
-		 * autodetect which interface the user wants, hence the
-		 * module parameter -- Arjan
-		 */
-
-	 	init.pitch_bits = init.h;
-	 	init.pitch = init.w;
-	 	init.h = init.overlay_physical;
-	 	init.w = init.overlay_offset;
-	 	init.overlay_physical = 0;
-	 	init.overlay_offset = 0;
-	}
-
    	switch(init.func) {
 	 	case I810_INIT_DMA:
 	   		dev_priv = DRM(alloc)(sizeof(drm_i810_private_t),
