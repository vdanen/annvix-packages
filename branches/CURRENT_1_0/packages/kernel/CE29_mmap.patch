--- bk-2.4/mm/mmap.c~	2003-09-25 11:12:23.000000000 +0100
+++ bk-2.4/mm/mmap.c	2003-09-25 11:13:06.000000000 +0100
@@ -1041,6 +1041,9 @@
 	if (!len)
 		return addr;
 
+	if ((addr + len) > TASK_SIZE || (addr + len) < addr)
+		return -EINVAL;
+
 	/*
 	 * mlock MCL_FUTURE?
 	 */
