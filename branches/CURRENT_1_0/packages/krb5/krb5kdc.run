#!/bin/sh
PATH="/sbin:/usr/sbin:/bin:/usr/bin:$PATH"

# this runs kadmind under supervise

godown() {
  touch down
  svc -d /service/kadmind
  touch log/down
  svc -d /service/kadmind/log
  exit 0
}

if [ ! -f /etc/kerberos/krb5kdc/principal ]; then
  godown
fi

exec /usr/sbin/krb5kdc -n
